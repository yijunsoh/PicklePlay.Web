@model Schedule
@using PicklePlay.Models

<div class="col">
    <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
            <h5 class="card-title">@Model.GameName</h5>
            <p class="card-text mb-1 small"><i class="bi bi-geo-alt-fill me-1"></i> @Model.Location</p>
            <p class="card-text mb-1 small">
                <i class="bi bi-calendar-event me-1"></i>
                @if (Model.StartTime.HasValue) {
                    <span>@Model.StartTime.Value.ToString("ddd, MMM d")</span>
                    <small class="text-muted"> (@Model.StartTime.Value.ToString("t") - @Model.EndTime?.ToString("t"))</small>
                }
            </p>
            <p class="card-text small"><i class="bi bi-trophy-fill me-1"></i> @Model.NumTeam Teams</p>

            @* Status and Action Buttons *@
            @if (Model.Status == ScheduleStatus.PendingSetup)
            {
                <span class="badge bg-warning text-dark align-self-start mb-2"><i class="bi bi-exclamation-triangle-fill me-1"></i> Pending Match Setup</span>
                <div class="mt-auto pt-2 d-grid gap-2 d-sm-flex justify-content-sm-between">
                    <a asp-controller="Community" asp-action="SetupMatch" asp-route-id="@Model.ScheduleId" class="btn btn-sm btn-warning mb-1 mb-sm-0">Continue Setup</a>
                    <form asp-controller="Community" asp-action="Publish" asp-route-id="@Model.ScheduleId" method="post" onsubmit="return confirm('Publish this competition? Default format settings will be used if setup is incomplete.')" class="d-inline-block">
                         @Html.AntiForgeryToken()
                         <button type="submit" class="btn btn-sm btn-info w-100">Publish Now</button>
                    </form>
                 </div>
            }
            else // Active, Past, etc.
            {
                string statusBadgeClass = "bg-secondary"; // Default
                if (Model.Status == ScheduleStatus.Active) { statusBadgeClass = "bg-success"; }
                else if (Model.Status == ScheduleStatus.Past) { statusBadgeClass = "bg-dark"; }
                
                <span class="badge @statusBadgeClass align-self-start mb-2">@Model.Status?.ToString()</span>
                 <div class="mt-auto pt-2">
                     <a asp-controller="Competition" asp-action="CompDetails" asp-route-id="@Model.ScheduleId" class="btn btn-sm btn-outline-primary w-100">View Competition</a>
                 </div>
            }
        </div>
    </div>
</div>