@{
    ViewData["Title"] = "Refund Management";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="p-4">
    <h3>Refunds Requests</h3><br>
    <div class="mb-3">
        <input type="text" id="refundSearch" class="form-control" placeholder="Search by member, game, or date...">
    </div>
    <div class="card shadow">
        <div class="card-header bg-dark text-white">
            Pending Refund Requests
        </div>
        <div class="card-body">
            <table class="table table-hover align-middle" id="refundTable">
                <thead>
                    <tr>
                        <th>Refund ID</th>
                        <th>Member</th>
                        <th>Game Title</th>
                        <th>Amount</th>
                        <th>Reason</th>
                        <th>Game Start</th>
                        <th>Request Date & Time</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>R001</td>
                        <td>John Doe</td>
                        <td>Battle Royale</td>
                        <td>RM 50</td>
                        <td>Request to cancel participation</td>
                        <td>28 Aug 2025, 3:00 PM</td>
                        <td>25 Aug 2025, 2:15 PM</td>
                        <td>
                            <button class="btn btn-success btn-sm">Accept</button>
                            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#rejectModal">Reject</button>
                        </td>
                    </tr>
                    <tr>
                        <td>R002</td>
                        <td>Jane Smith</td>
                        <td>Puzzle Quest</td>
                        <td>RM 30</td>
                        <td>Request to cancel participation</td>
                        <td>1 Sep 2025, 10:00 AM</td>
                        <td>29 Aug 2025, 5:45 PM</td>
                        <td>
                            <button class="btn btn-success btn-sm">Accept</button>
                            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#rejectModal">Reject</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Reject Modal -->
<div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="rejectModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="rejectModalLabel">Reject Refund Request</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to reject this refund request?</p>
                <div class="mb-3">
                    <label for="rejectionReason" class="form-label">Reason for Rejection</label>
                    <textarea class="form-control" id="rejectionReason" rows="3" placeholder="Enter reason..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger">Reject</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('refundSearch').addEventListener('keyup', function() {
            let filter = this.value.toLowerCase();
            let rows = document.querySelectorAll('#refundTable tbody tr');

            rows.forEach(row => {
                let text = row.innerText.toLowerCase();
                row.style.display = text.includes(filter) ? '' : 'none';
            });
        });
    </script>
}